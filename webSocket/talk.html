<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>交谈</title>
    <script type="text/javascript" src="node_modules/socket.io/node_modules/socket.io-client/dist/socket.io.js"></script> 
</head>
<body>
<div class="box">
    <h4 class="talk_t">交流列表</h4>
    <ul class="talk_m"></ul>
    <input type="text" id="talkTxt" placehoddle="输入内容"><br />
    <input type="button" id="sendTalk" value="发送">
</div>
<script>
var oList = document.querySelector(".talk_m");
function talkSocket(){
    if(!window.WebSocket){
        return false;
    }
    // 与服务器建立链接
    var connection = new Websocket("ws://localhost:4562");

    // 链接成功会触发 open 事件
    connection.onopen = function(){
        console.log("服务器链接成功");
    }

    // 关闭 WebSocket链接会触发 close 事件
    connection.onclose = function(){
        console.log("服务器链接断开");
    }

    var oTxt = document.querySelector("talkTxt"),
        oBtn = document.querySelector("sendTalk");
    oBtn.onclick = function(){
        // 客户端像服务器发送数据用send方法
        connection.send(oTxt.value);

        // 客户端接收到服务器返回的数据会触发 message 事件，函数的参数为事件对象event，该对象的data属性包含了服务器返回的数据
        connection.onmessage = function(event){
            oList.innerHTML += event.data;
        }
    }
}
talkSocket();
</script>
</body>
</html>